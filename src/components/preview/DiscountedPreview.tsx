import type { IDiscountedProperties, IPriceBlockSettings } from "../types";
import type { CSSProperties } from "react";
import { useMemo } from "react";
import useBoxStyle from "../../hooks/useBoxStyle";
import useFontStyle from "../../hooks/useFontStyle";
import SeparateNumberFormatted from "../separate-number-formatted/SeparateNumberFormatted";
import { usePriceBlockStore } from "../../zustand/price-block-store";

const DiscountedPreview = ({ settings, properties }: { settings: IPriceBlockSettings; properties: IDiscountedProperties }) => {
  //const element = priceBlockElements[PriceBlockElementKey.DISCOUNTED] as IPriceBlockElement<IDiscountedProperties>;
  const boxStyle = useBoxStyle({ box: properties.box });
  const fontStyle = useFontStyle({ font: properties.font });
  const priceDiscounted = usePriceBlockStore((state) => state.priceDiscounted);

  const getStyle = useMemo((): CSSProperties => {
    return { ...boxStyle, ...fontStyle };
  }, [boxStyle, fontStyle]);

  if (!properties) return null;

  return (
    <div className={"flex h-full w-full flex-col justify-center"} style={getStyle}>
      <SeparateNumberFormatted
        thousandSeparator={settings.separator.thousand}
        decimalSeparator={settings.separator.decimal}
        showCurrency={properties.showCurrency}
        fontSize={properties.font.size}
        currency={settings.currency}
        value={priceDiscounted?.value?.length ? priceDiscounted.value?.[0] : properties.exampleContent}
        type={properties.format.isEnable ? properties.format.type : undefined}
      />
    </div>
  );
};

export default DiscountedPreview;
